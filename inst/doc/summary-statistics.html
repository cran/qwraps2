<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Peter DeWitt" />

<meta name="date" content="2019-12-02" />

<title>Formatted Summary Statistics and Data Summary Tables with qwraps2</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Formatted Summary Statistics and Data Summary Tables with qwraps2</h1>
<h4 class="author">Peter DeWitt</h4>
<h4 class="date">2019-12-02</h4>


<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="#prerequisites-example-data-set"><span class="toc-section-number">1.1</span> Prerequisites Example Data Set</a></li>
</ul></li>
<li><a href="#review-of-summary-statistic-functions-and-formatting"><span class="toc-section-number">2</span> Review of Summary Statistic Functions and Formatting</a><ul>
<li><a href="#means-and-standard-deviations"><span class="toc-section-number">2.1</span> Means and Standard Deviations</a></li>
<li><a href="#mean-and-confidence-intervals"><span class="toc-section-number">2.2</span> Mean and Confidence intervals</a></li>
<li><a href="#median-and-inner-quartile-range"><span class="toc-section-number">2.3</span> Median and Inner Quartile Range</a></li>
<li><a href="#count-and-percentages"><span class="toc-section-number">2.4</span> Count and Percentages</a></li>
<li><a href="#geometric-means-and-standard-deviations"><span class="toc-section-number">2.5</span> Geometric Means and Standard Deviations</a></li>
</ul></li>
<li><a href="#building-a-data-summary-table"><span class="toc-section-number">3</span> Building a Data Summary Table</a><ul>
<li><a href="#easy-building-of-the-summaries"><span class="toc-section-number">3.1</span> Easy building of the summaries</a></li>
<li><a href="#adding-p-values-to-a-summary-table"><span class="toc-section-number">3.2</span> Adding P-values to a Summary Table</a></li>
<li><a href="#using-variable-labels"><span class="toc-section-number">3.3</span> Using Variable Labels</a></li>
</ul></li>
<li><a href="#session-info"><span class="toc-section-number">4</span> Session Info</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>It is common for a manuscript to require a data summary table. The table might include simple summary statistics for the whole sample and for subgroups. There are several tools available to build such tables. In my opinion, though, most of those tools have nuances imposed by the creators/authors such that other users need not only understand the tool, but also think like the authors. I wrote this package to be as flexible and general as possible. I hope you like these tools and will be able to use them in your work.</p>
<p>This vignette presents the use of the <code>summary_table</code>, <code>qsummary</code>, and <code>qable</code> functions for quickly building data summary tables. These functions implicitly use the <code>mean_sd</code>, <code>median_iqr</code>, and <code>n_perc0</code> functions from <code>qwraps2</code> as well.</p>
<div id="prerequisites-example-data-set" class="section level2">
<h2><span class="header-section-number">1.1</span> Prerequisites Example Data Set</h2>
<p>We will use a modified version of the <code>mtcars</code> data set for examples throughout this vignette. The following packages are required to run the code in this vignette and to construct the <code>mtcars2</code> <code>data.frame</code>.</p>
<p>The <code>mtcars2</code> data frame will have three versions of the <code>cyl</code> vector: the original numeric values in <code>cyl</code>, a <code>character</code> version, and a <code>factor</code> version.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
<span class="kw">library</span>(magrittr)
<span class="kw">library</span>(qwraps2)

<span class="co"># define the markup language we are working in.</span>
<span class="co"># options(qwraps2_markup = &quot;latex&quot;) is also supported.</span>
<span class="kw">options</span>(<span class="dt">qwraps2_markup =</span> <span class="st">&quot;markdown&quot;</span>)

<span class="kw">data</span>(mtcars)

mtcars2 &lt;-
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(mtcars,
                <span class="dt">cyl_factor =</span> <span class="kw">factor</span>(cyl,
                                    <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">8</span>),
                                    <span class="dt">labels =</span> <span class="kw">paste</span>(<span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">8</span>), <span class="st">&quot;cylinders&quot;</span>)),
                <span class="dt">cyl_character =</span> <span class="kw">paste</span>(cyl, <span class="st">&quot;cylinders&quot;</span>))

<span class="kw">str</span>(mtcars2)
## 'data.frame':    32 obs. of  13 variables:
##  $ mpg          : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##  $ cyl          : num  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp         : num  160 160 108 258 360 ...
##  $ hp           : num  110 110 93 110 175 105 245 62 95 123 ...
##  $ drat         : num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##  $ wt           : num  2.62 2.88 2.32 3.21 3.44 ...
##  $ qsec         : num  16.5 17 18.6 19.4 17 ...
##  $ vs           : num  0 0 1 1 0 1 0 1 1 1 ...
##  $ am           : num  1 1 1 0 0 0 0 0 0 0 ...
##  $ gear         : num  4 4 4 3 3 3 3 4 4 4 ...
##  $ carb         : num  4 4 1 1 2 1 4 2 2 4 ...
##  $ cyl_factor   : Factor w/ 3 levels &quot;6 cylinders&quot;,..: 1 1 2 1 3 1 3 2 2 1 ...
##  $ cyl_character: chr  &quot;6 cylinders&quot; &quot;6 cylinders&quot; &quot;4 cylinders&quot; &quot;6 cylinders&quot; ...</code></pre></div>
<p>Notice that the construction of the <code>cyl_factor</code> and <code>cyl_character</code> vectors was done such that the coercion of <code>cyl_character</code> to a <code>factor</code> will not be the same as the <code>cyl_factor</code> vector; the levels are in a different order.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(mtcars2, <span class="kw">table</span>(cyl_factor, cyl_character))
##              cyl_character
## cyl_factor    4 cylinders 6 cylinders 8 cylinders
##   6 cylinders           0           7           0
##   4 cylinders          11           0           0
##   8 cylinders           0           0          14
<span class="kw">with</span>(mtcars2, <span class="kw">all.equal</span>(<span class="kw">factor</span>(cyl_character), cyl_factor))
## [1] &quot;Attributes: &lt; Component \&quot;levels\&quot;: 2 string mismatches &gt;&quot;</code></pre></div>
</div>
</div>
<div id="review-of-summary-statistic-functions-and-formatting" class="section level1">
<h1><span class="header-section-number">2</span> Review of Summary Statistic Functions and Formatting</h1>
<div id="means-and-standard-deviations" class="section level2">
<h2><span class="header-section-number">2.1</span> Means and Standard Deviations</h2>
<p><code>mean_sd</code> will return the (arithmetic) mean and standard deviation for numeric vector. For example, <code>mean_sd(mtcars2$mpg)</code> will return the formatted string.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean_sd</span>(mtcars2<span class="op">$</span>mpg)
## [1] &quot;20.09 &amp;plusmn; 6.03&quot;
<span class="kw">mean_sd</span>(mtcars2<span class="op">$</span>mpg, <span class="dt">denote_sd =</span> <span class="st">&quot;paren&quot;</span>)
## [1] &quot;20.09 (6.03)&quot;</code></pre></div>
<p>The default setting for <code>mean_sd</code> is to return the mean ± sd. In a table this default is helpful because the default table formatting for counts and percentages is n (%).</p>
<p><code>mean_sd</code> and other functions are helpful for in-line text too:</p>
<pre><code>The 32 vehicles in the `mtcars` data set had an average fuel
economy of 20.09 &amp;plusmn; 6.03 miles per gallon.</code></pre>
<p>produces</p>
<blockquote>
<p>The 32 vehicles in the <code>mtcars</code> data set had an average fuel economy of 20.09 ± 6.03 miles per gallon.</p>
</blockquote>
</div>
<div id="mean-and-confidence-intervals" class="section level2">
<h2><span class="header-section-number">2.2</span> Mean and Confidence intervals</h2>
<p>If you need the mean and a confidence interval there is <code>mean_ci</code>. <code>mean_ci</code> returns a <code>qwraps2_mean_ci</code> object which is a named vector with the mean, lower confidence limit, and the upper confidence limit. The printing method for <code>qwraps2_mean_ci</code> objects is a call to the <code>frmtci</code> function. You an modify the formatting of printed result by adjusting the arguments pasted to <code>frmtci</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mci &lt;-<span class="st"> </span><span class="kw">mean_ci</span>(mtcars2<span class="op">$</span>mpg)
mci
## [1] &quot;20.09 (18.00, 22.18)&quot;
<span class="kw">print</span>(mci, <span class="dt">show_level =</span> <span class="ot">TRUE</span>)
## [1] &quot;20.09 (95% CI: 18.00, 22.18)&quot;</code></pre></div>
</div>
<div id="median-and-inner-quartile-range" class="section level2">
<h2><span class="header-section-number">2.3</span> Median and Inner Quartile Range</h2>
<p>Similar to the <code>mean_sd</code> function, the <code>median_iqr</code> returns the median and the inner quartile range (IQR) of a data vector.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median_iqr</span>(mtcars2<span class="op">$</span>mpg)
## [1] &quot;19.20 (15.43, 22.80)&quot;</code></pre></div>
</div>
<div id="count-and-percentages" class="section level2">
<h2><span class="header-section-number">2.4</span> Count and Percentages</h2>
<p>The <code>n_perc</code> function is the workhorse, but <code>n_perc0</code> is also provided for ease of use in the same way that base R has <code>paste</code> and <code>paste0</code>. <code>n_perc</code> returns the n (%) with the percentage sign in the string, <code>n_perc0</code> omits the percentage sign from the string. The latter is good for tables, the former for in-line text.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">n_perc</span>(mtcars2<span class="op">$</span>cyl <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)
## [1] &quot;11 (34.38%)&quot;
<span class="kw">n_perc0</span>(mtcars2<span class="op">$</span>cyl <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)
## [1] &quot;11 (34)&quot;

<span class="kw">n_perc</span>(mtcars2<span class="op">$</span>cyl_factor <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)  <span class="co"># this returns 0 (0.00%)</span>
## [1] &quot;0 (0.00%)&quot;
<span class="kw">n_perc</span>(mtcars2<span class="op">$</span>cyl_factor <span class="op">==</span><span class="st"> &quot;4 cylinders&quot;</span>)
## [1] &quot;11 (34.38%)&quot;
<span class="kw">n_perc</span>(mtcars2<span class="op">$</span>cyl_factor <span class="op">==</span><span class="st"> </span><span class="kw">levels</span>(mtcars2<span class="op">$</span>cyl_factor)[<span class="dv">2</span>])
## [1] &quot;11 (34.38%)&quot;

<span class="co"># The count and percentage of 4 or 6 cylinders vehicles in the data set is</span>
<span class="kw">n_perc</span>(mtcars2<span class="op">$</span>cyl <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">6</span>))
## [1] &quot;18 (56.25%)&quot;</code></pre></div>
</div>
<div id="geometric-means-and-standard-deviations" class="section level2">
<h2><span class="header-section-number">2.5</span> Geometric Means and Standard Deviations</h2>
<p>Let <span class="math inline">\(\left\{x_1, x_2, x_3, \ldots, x_n \right\}\)</span> be a sample of size <span class="math inline">\(n\)</span> with <span class="math inline">\(x_i &gt; 0\)</span> for all <span class="math inline">\(i.\)</span> Then the geometric mean, <span class="math inline">\(\mu_g,\)</span> and geometric standard deviation are</p>
<p><span class="math display">\[
\begin{equation}
  \mu_g = \left( \prod_{i = 1}^{n} x_i \right)^{\frac{1}{n}} = b^{ \sum_{i =
  1}^{n} \log_{b} x_i },
\end{equation}
\]</span> and <span class="math display">\[
\begin{equation}
  \sigma_g = b ^ {
  \sqrt{
    \frac{\sum_{i = 1}^{n} \left( \log_{b} \frac{x_i}{\mu_g} \right)^2}{n}
  }
  }
\end{equation}
\]</span> or, for clarity, <span class="math display">\[
\begin{equation}
  \log_{b} \sigma_g =
  \sqrt{ \frac{\sum_{i = 1}^{n} \left( \log_{b} \frac{x_i}{\mu_g}
  \right)^2}{n}}
\end{equation}
\]</span></p>
<p>When looking for the geometric standard deviation in R, the simple <code>exp(sd(log(x)))</code> is not exactly correct. The geometric standard deviation uses <span class="math inline">\(n,\)</span> the full sample size, in the denominator, where as the <code>sd</code> and <code>var</code> functions in R use the denominator <span class="math inline">\(n - 1.\)</span> To get the geometric standard deviation one should adjust the result by multiplying the variance by <span class="math inline">\((n - 1) / n\)</span> or the standard deviation by <span class="math inline">\(\sqrt{(n - 1) / n}.\)</span> See the example below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">6</span>, <span class="dt">min =</span> <span class="dv">4</span>, <span class="dt">max =</span> <span class="dv">70</span>)

<span class="co"># geometric mean</span>
mu_g &lt;-<span class="st"> </span><span class="kw">prod</span>(x) <span class="op">**</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(x))
mu_g
## [1] 46.50714
<span class="kw">exp</span>(<span class="kw">mean</span>(<span class="kw">log</span>(x)))
## [1] 46.50714
<span class="fl">1.2</span> <span class="op">**</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(x, <span class="dt">base =</span> <span class="fl">1.2</span>))
## [1] 46.50714

<span class="co"># geometric standard deviation</span>
<span class="kw">exp</span>(<span class="kw">sd</span>(<span class="kw">log</span>(x)))  ## This is wrong
## [1] 1.500247

<span class="co"># these equations are correct</span>
sigma_g &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="kw">log</span>(x <span class="op">/</span><span class="st"> </span>mu_g) <span class="op">**</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(x)))
sigma_g
## [1] 1.448151

<span class="kw">exp</span>(<span class="kw">sqrt</span>((<span class="kw">length</span>(x) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(x)) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(x)))
## [1] 1.448151</code></pre></div>
<p>The functions <code>gmean</code>, <code>gvar</code>, and <code>gsd</code> in the package, provide the geometric mean, variance, and standard deviation for a sample.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gmean</span>(x)
## [1] 46.50714
<span class="kw">all.equal</span>(<span class="kw">gmean</span>(x), mu_g)
## [1] TRUE

<span class="kw">gvar</span>(x)
## [1] 1.146958
<span class="kw">all.equal</span>(<span class="kw">gvar</span>(x), sigma_g<span class="op">^</span><span class="dv">2</span>)  <span class="co"># This is supposed to be FALSE</span>
## [1] &quot;Mean relative difference: 0.8284385&quot;
<span class="kw">all.equal</span>(<span class="kw">gvar</span>(x), <span class="kw">exp</span>(<span class="kw">log</span>(sigma_g)<span class="op">^</span><span class="dv">2</span>))
## [1] TRUE

<span class="kw">gsd</span>(x)
## [1] 1.448151
<span class="kw">all.equal</span>(<span class="kw">gsd</span>(x), sigma_g)
## [1] TRUE</code></pre></div>
<p><code>gmean_sd</code> will provide a quick way for reporting the geometric mean and geometric standard deviation in the same way that <code>mean_sd</code> does for the arithmetic mean and arithmetic standard deviation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gmean_sd</span>(x)
## [1] &quot;46.51 &amp;plusmn; 1.45&quot;</code></pre></div>
</div>
</div>
<div id="building-a-data-summary-table" class="section level1">
<h1><span class="header-section-number">3</span> Building a Data Summary Table</h1>
<p>Objective: build a table reporting summary statistics for some of the variables in the <code>mtcars2</code> <code>data.frame</code> overall and within subgroups. We’ll start with something very simple and build up to something bigger.</p>
<p>Let’s report the min, max, and mean (sd) for continuous variables and n (%) for categorical variables. We will report <code>mpg</code>, <code>disp</code>, <code>wt</code>, and <code>gear</code> overall and by number of cylinders.</p>
<p>The function <code>summary_table</code>, along with some <code>dplyr</code> functions will do the work for us. <code>summary_table</code> takes two arguments:</p>
<ol style="list-style-type: decimal">
<li><code>x</code> a (<code>grouped_df</code>) data.frame.</li>
<li><code>summaries</code> a list of summaries. This is a list-of-lists. The outer list defines the row groups and the inner lists define the specif summaries. The default is generated by the <code>qsummary</code> function.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(summary_table)
## function (x, summaries = qsummary(x)) 
## NULL</code></pre></div>
<p>Let’s build a list-of-lists to pass to the <code>summaries</code> argument of <code>summary_table</code>. Additional examples and tools for building the list-of-lists are given in the following section. The immediate example is provided to demonstrate how to use the <code>summary_table</code> method.</p>
<p>The inner lists are named <code>formula</code>e defining the wanted summary. These <code>formula</code>e are passed through <code>dplyr::summarize</code> to generate the table. The names are important, as they are used to label row groups and row names in the table. The arguemnt for the functions below use the <code>.data</code> pronoun for tidy evaluation (see <code>help(topic = &quot;.data&quot;, package = &quot;rlang&quot;)</code>). The use of this pronoun is not mandatory, however, the use of the pronoun is strongly encouraged.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">our_summary1 &lt;-
<span class="st">  </span><span class="kw">list</span>(<span class="st">&quot;Miles Per Gallon&quot;</span> =
<span class="st">       </span><span class="kw">list</span>(<span class="st">&quot;min&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">min</span>(.data<span class="op">$</span>mpg),
            <span class="st">&quot;max&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">max</span>(.data<span class="op">$</span>mpg),
            <span class="st">&quot;mean (sd)&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">mean_sd</span>(.data<span class="op">$</span>mpg)),
       <span class="st">&quot;Displacement&quot;</span> =
<span class="st">       </span><span class="kw">list</span>(<span class="st">&quot;min&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">min</span>(.data<span class="op">$</span>disp),
            <span class="st">&quot;median&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">median</span>(.data<span class="op">$</span>disp),
            <span class="st">&quot;max&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">max</span>(.data<span class="op">$</span>disp),
            <span class="st">&quot;mean (sd)&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">mean_sd</span>(.data<span class="op">$</span>disp)),
       <span class="st">&quot;Weight (1000 lbs)&quot;</span> =
<span class="st">       </span><span class="kw">list</span>(<span class="st">&quot;min&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">min</span>(.data<span class="op">$</span>wt),
            <span class="st">&quot;max&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">max</span>(.data<span class="op">$</span>wt),
            <span class="st">&quot;mean (sd)&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">mean_sd</span>(.data<span class="op">$</span>wt)),
       <span class="st">&quot;Forward Gears&quot;</span> =
<span class="st">       </span><span class="kw">list</span>(<span class="st">&quot;Three&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">n_perc0</span>(.data<span class="op">$</span>gear <span class="op">==</span><span class="st"> </span><span class="dv">3</span>),
            <span class="st">&quot;Four&quot;</span>  =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">n_perc0</span>(.data<span class="op">$</span>gear <span class="op">==</span><span class="st"> </span><span class="dv">4</span>),
            <span class="st">&quot;Five&quot;</span>  =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">n_perc0</span>(.data<span class="op">$</span>gear <span class="op">==</span><span class="st"> </span><span class="dv">5</span>))
       )</code></pre></div>
<p>Building the table is done with a call to <code>summary_table</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### Overall
whole &lt;-<span class="st"> </span><span class="kw">summary_table</span>(mtcars2, our_summary1)
whole</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">mtcars2 (N = 32)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Miles Per Gallon</strong></td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">10.4</td>
</tr>
<tr class="odd">
<td align="left">   max</td>
<td align="left">33.9</td>
</tr>
<tr class="even">
<td align="left">   mean (sd)</td>
<td align="left">20.09 ± 6.03</td>
</tr>
<tr class="odd">
<td align="left"><strong>Displacement</strong></td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">71.1</td>
</tr>
<tr class="odd">
<td align="left">   median</td>
<td align="left">196.3</td>
</tr>
<tr class="even">
<td align="left">   max</td>
<td align="left">472</td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">230.72 ± 123.94</td>
</tr>
<tr class="even">
<td align="left"><strong>Weight (1000 lbs)</strong></td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   min</td>
<td align="left">1.513</td>
</tr>
<tr class="even">
<td align="left">   max</td>
<td align="left">5.424</td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">3.22 ± 0.98</td>
</tr>
<tr class="even">
<td align="left"><strong>Forward Gears</strong></td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   Three</td>
<td align="left">15 (47)</td>
</tr>
<tr class="even">
<td align="left">   Four</td>
<td align="left">12 (38)</td>
</tr>
<tr class="odd">
<td align="left">   Five</td>
<td align="left">5 (16)</td>
</tr>
</tbody>
</table>
<p>The <code>summary_table</code> will work with grouped data frames too.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### By number of Cylinders
by_cyl &lt;-<span class="st"> </span><span class="kw">summary_table</span>(dplyr<span class="op">::</span><span class="kw">group_by</span>(mtcars2, cyl_factor), our_summary1)
by_cyl</code></pre></div>
<table>
<colgroup>
<col width="19%"></col>
<col width="26%"></col>
<col width="27%"></col>
<col width="27%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">cyl_factor: 6 cylinders (N = 7)</th>
<th align="left">cyl_factor: 4 cylinders (N = 11)</th>
<th align="left">cyl_factor: 8 cylinders (N = 14)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Miles Per Gallon</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">17.8</td>
<td align="left">21.4</td>
<td align="left">10.4</td>
</tr>
<tr class="odd">
<td align="left">   max</td>
<td align="left">21.4</td>
<td align="left">33.9</td>
<td align="left">19.2</td>
</tr>
<tr class="even">
<td align="left">   mean (sd)</td>
<td align="left">19.74 ± 1.45</td>
<td align="left">26.66 ± 4.51</td>
<td align="left">15.10 ± 2.56</td>
</tr>
<tr class="odd">
<td align="left"><strong>Displacement</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">145.0</td>
<td align="left">71.1</td>
<td align="left">275.8</td>
</tr>
<tr class="odd">
<td align="left">   median</td>
<td align="left">167.6</td>
<td align="left">108.0</td>
<td align="left">350.5</td>
</tr>
<tr class="even">
<td align="left">   max</td>
<td align="left">258.0</td>
<td align="left">146.7</td>
<td align="left">472.0</td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">183.31 ± 41.56</td>
<td align="left">105.14 ± 26.87</td>
<td align="left">353.10 ± 67.77</td>
</tr>
<tr class="even">
<td align="left"><strong>Weight (1000 lbs)</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   min</td>
<td align="left">2.620</td>
<td align="left">1.513</td>
<td align="left">3.170</td>
</tr>
<tr class="even">
<td align="left">   max</td>
<td align="left">3.460</td>
<td align="left">3.190</td>
<td align="left">5.424</td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">3.12 ± 0.36</td>
<td align="left">2.29 ± 0.57</td>
<td align="left">4.00 ± 0.76</td>
</tr>
<tr class="even">
<td align="left"><strong>Forward Gears</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   Three</td>
<td align="left">2 (29)</td>
<td align="left">1 (9)</td>
<td align="left">12 (86)</td>
</tr>
<tr class="even">
<td align="left">   Four</td>
<td align="left">4 (57)</td>
<td align="left">8 (73)</td>
<td align="left">0 (0)</td>
</tr>
<tr class="odd">
<td align="left">   Five</td>
<td align="left">1 (14)</td>
<td align="left">2 (18)</td>
<td align="left">2 (14)</td>
</tr>
</tbody>
</table>
<p>To report a table with both the whole sample summary and conditional columns together:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">both &lt;-<span class="st"> </span><span class="kw">cbind</span>(whole, by_cyl)
both</code></pre></div>
<table>
<colgroup>
<col width="16%"></col>
<col width="16%"></col>
<col width="22%"></col>
<col width="22%"></col>
<col width="22%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">mtcars2 (N = 32)</th>
<th align="left">cyl_factor: 6 cylinders (N = 7)</th>
<th align="left">cyl_factor: 4 cylinders (N = 11)</th>
<th align="left">cyl_factor: 8 cylinders (N = 14)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Miles Per Gallon</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">10.4</td>
<td align="left">17.8</td>
<td align="left">21.4</td>
<td align="left">10.4</td>
</tr>
<tr class="odd">
<td align="left">   max</td>
<td align="left">33.9</td>
<td align="left">21.4</td>
<td align="left">33.9</td>
<td align="left">19.2</td>
</tr>
<tr class="even">
<td align="left">   mean (sd)</td>
<td align="left">20.09 ± 6.03</td>
<td align="left">19.74 ± 1.45</td>
<td align="left">26.66 ± 4.51</td>
<td align="left">15.10 ± 2.56</td>
</tr>
<tr class="odd">
<td align="left"><strong>Displacement</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">71.1</td>
<td align="left">145.0</td>
<td align="left">71.1</td>
<td align="left">275.8</td>
</tr>
<tr class="odd">
<td align="left">   median</td>
<td align="left">196.3</td>
<td align="left">167.6</td>
<td align="left">108.0</td>
<td align="left">350.5</td>
</tr>
<tr class="even">
<td align="left">   max</td>
<td align="left">472</td>
<td align="left">258.0</td>
<td align="left">146.7</td>
<td align="left">472.0</td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">230.72 ± 123.94</td>
<td align="left">183.31 ± 41.56</td>
<td align="left">105.14 ± 26.87</td>
<td align="left">353.10 ± 67.77</td>
</tr>
<tr class="even">
<td align="left"><strong>Weight (1000 lbs)</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   min</td>
<td align="left">1.513</td>
<td align="left">2.620</td>
<td align="left">1.513</td>
<td align="left">3.170</td>
</tr>
<tr class="even">
<td align="left">   max</td>
<td align="left">5.424</td>
<td align="left">3.460</td>
<td align="left">3.190</td>
<td align="left">5.424</td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">3.22 ± 0.98</td>
<td align="left">3.12 ± 0.36</td>
<td align="left">2.29 ± 0.57</td>
<td align="left">4.00 ± 0.76</td>
</tr>
<tr class="even">
<td align="left"><strong>Forward Gears</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   Three</td>
<td align="left">15 (47)</td>
<td align="left">2 (29)</td>
<td align="left">1 (9)</td>
<td align="left">12 (86)</td>
</tr>
<tr class="even">
<td align="left">   Four</td>
<td align="left">12 (38)</td>
<td align="left">4 (57)</td>
<td align="left">8 (73)</td>
<td align="left">0 (0)</td>
</tr>
<tr class="odd">
<td align="left">   Five</td>
<td align="left">5 (16)</td>
<td align="left">1 (14)</td>
<td align="left">2 (18)</td>
<td align="left">2 (14)</td>
</tr>
</tbody>
</table>
<p>If you want to change the column names, do so via the <code>cnames</code> argument to <code>qable</code> via the print method for <code>qwraps2_summary_table</code> objects. Any argument that you want to send to <code>qable</code> can be sent there when explicitly using the <code>print</code> method for <code>qwraps2_summary_table</code> objects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(both,
      <span class="dt">rtitle =</span> <span class="st">&quot;Summary Statistics&quot;</span>,
      <span class="dt">cnames =</span> <span class="kw">c</span>(<span class="st">&quot;Col 0&quot;</span>, <span class="st">&quot;Col 1&quot;</span>, <span class="st">&quot;Col 2&quot;</span>, <span class="st">&quot;Col 3&quot;</span>))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Summary Statistics</th>
<th align="left">Col 0</th>
<th align="left">Col 1</th>
<th align="left">Col 2</th>
<th align="left">Col 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Miles Per Gallon</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">10.4</td>
<td align="left">17.8</td>
<td align="left">21.4</td>
<td align="left">10.4</td>
</tr>
<tr class="odd">
<td align="left">   max</td>
<td align="left">33.9</td>
<td align="left">21.4</td>
<td align="left">33.9</td>
<td align="left">19.2</td>
</tr>
<tr class="even">
<td align="left">   mean (sd)</td>
<td align="left">20.09 ± 6.03</td>
<td align="left">19.74 ± 1.45</td>
<td align="left">26.66 ± 4.51</td>
<td align="left">15.10 ± 2.56</td>
</tr>
<tr class="odd">
<td align="left"><strong>Displacement</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">71.1</td>
<td align="left">145.0</td>
<td align="left">71.1</td>
<td align="left">275.8</td>
</tr>
<tr class="odd">
<td align="left">   median</td>
<td align="left">196.3</td>
<td align="left">167.6</td>
<td align="left">108.0</td>
<td align="left">350.5</td>
</tr>
<tr class="even">
<td align="left">   max</td>
<td align="left">472</td>
<td align="left">258.0</td>
<td align="left">146.7</td>
<td align="left">472.0</td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">230.72 ± 123.94</td>
<td align="left">183.31 ± 41.56</td>
<td align="left">105.14 ± 26.87</td>
<td align="left">353.10 ± 67.77</td>
</tr>
<tr class="even">
<td align="left"><strong>Weight (1000 lbs)</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   min</td>
<td align="left">1.513</td>
<td align="left">2.620</td>
<td align="left">1.513</td>
<td align="left">3.170</td>
</tr>
<tr class="even">
<td align="left">   max</td>
<td align="left">5.424</td>
<td align="left">3.460</td>
<td align="left">3.190</td>
<td align="left">5.424</td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">3.22 ± 0.98</td>
<td align="left">3.12 ± 0.36</td>
<td align="left">2.29 ± 0.57</td>
<td align="left">4.00 ± 0.76</td>
</tr>
<tr class="even">
<td align="left"><strong>Forward Gears</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   Three</td>
<td align="left">15 (47)</td>
<td align="left">2 (29)</td>
<td align="left">1 (9)</td>
<td align="left">12 (86)</td>
</tr>
<tr class="even">
<td align="left">   Four</td>
<td align="left">12 (38)</td>
<td align="left">4 (57)</td>
<td align="left">8 (73)</td>
<td align="left">0 (0)</td>
</tr>
<tr class="odd">
<td align="left">   Five</td>
<td align="left">5 (16)</td>
<td align="left">1 (14)</td>
<td align="left">2 (18)</td>
<td align="left">2 (14)</td>
</tr>
</tbody>
</table>
<div id="easy-building-of-the-summaries" class="section level2">
<h2><span class="header-section-number">3.1</span> Easy building of the summaries</h2>
<p>The task of building the <code>summaries</code> list-of-lists can be tedious. <code>qsummary</code> is designed to make it easier. <code>qsummary</code> will use a set of predefined functions to summarize numeric columns of a <code>data.frame</code>, a set of arguments to pass to <code>qwraps2::n_perc</code> for categorical (<code>character</code> and <code>factors</code>) variables.</p>
<p>By default, calling <code>summary_table</code> will use the default summary metrics defined by <code>qsummary</code>. The purpose of <code>qsummary</code> is to provide the same summary for all numeric variables within a data.frame and a single style of summary for categorical variables within the data.frame. For example, the default summary for a set of variables from the the <code>mtcars2</code> data set is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars2 <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(.data<span class="op">$</span>mpg, .data<span class="op">$</span>cyl_factor, .data<span class="op">$</span>wt) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">qsummary</span>(.)
## $mpg
## $mpg$minimum
## ~qwraps2::frmt(min(.data[[&quot;mpg&quot;]]))
## &lt;environment: 0x555ad3e3a688&gt;
## 
## $mpg$`median (IQR)`
## ~qwraps2::median_iqr(.data[[&quot;mpg&quot;]])
## &lt;environment: 0x555ad3e3a688&gt;
## 
## $mpg$`mean (sd)`
## ~qwraps2::mean_sd(.data[[&quot;mpg&quot;]])
## &lt;environment: 0x555ad3e3a688&gt;
## 
## $mpg$maximum
## ~qwraps2::frmt(max(.data[[&quot;mpg&quot;]]))
## &lt;environment: 0x555ad3e3a688&gt;
## 
## 
## $cyl_factor
## $cyl_factor$`6 cylinders`
## ~qwraps2::n_perc(.data[[&quot;cyl_factor&quot;]] == &quot;6 cylinders&quot;, digits = 0, 
##     show_symbol = FALSE)
## &lt;environment: 0x555ad3e3a688&gt;
## 
## $cyl_factor$`4 cylinders`
## ~qwraps2::n_perc(.data[[&quot;cyl_factor&quot;]] == &quot;4 cylinders&quot;, digits = 0, 
##     show_symbol = FALSE)
## &lt;environment: 0x555ad3e3a688&gt;
## 
## $cyl_factor$`8 cylinders`
## ~qwraps2::n_perc(.data[[&quot;cyl_factor&quot;]] == &quot;8 cylinders&quot;, digits = 0, 
##     show_symbol = FALSE)
## &lt;environment: 0x555ad3e3a688&gt;
## 
## 
## $wt
## $wt$minimum
## ~qwraps2::frmt(min(.data[[&quot;wt&quot;]]))
## &lt;environment: 0x555ad3e3a688&gt;
## 
## $wt$`median (IQR)`
## ~qwraps2::median_iqr(.data[[&quot;wt&quot;]])
## &lt;environment: 0x555ad3e3a688&gt;
## 
## $wt$`mean (sd)`
## ~qwraps2::mean_sd(.data[[&quot;wt&quot;]])
## &lt;environment: 0x555ad3e3a688&gt;
## 
## $wt$maximum
## ~qwraps2::frmt(max(.data[[&quot;wt&quot;]]))
## &lt;environment: 0x555ad3e3a688&gt;</code></pre></div>
<p>That default summary is used for a table as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars2 <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(.data<span class="op">$</span>mpg, .data<span class="op">$</span>cyl_factor, .data<span class="op">$</span>wt) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summary_table</span>(.)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">. (N = 32)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>mpg</strong></td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   minimum</td>
<td align="left">10.40</td>
</tr>
<tr class="odd">
<td align="left">   median (IQR)</td>
<td align="left">19.20 (15.43, 22.80)</td>
</tr>
<tr class="even">
<td align="left">   mean (sd)</td>
<td align="left">20.09 ± 6.03</td>
</tr>
<tr class="odd">
<td align="left">   maximum</td>
<td align="left">33.90</td>
</tr>
<tr class="even">
<td align="left"><strong>cyl_factor</strong></td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   6 cylinders</td>
<td align="left">7 (22)</td>
</tr>
<tr class="even">
<td align="left">   4 cylinders</td>
<td align="left">11 (34)</td>
</tr>
<tr class="odd">
<td align="left">   8 cylinders</td>
<td align="left">14 (44)</td>
</tr>
<tr class="even">
<td align="left"><strong>wt</strong></td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   minimum</td>
<td align="left">1.51</td>
</tr>
<tr class="even">
<td align="left">   median (IQR)</td>
<td align="left">3.33 (2.58, 3.61)</td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">3.22 ± 0.98</td>
</tr>
<tr class="even">
<td align="left">   maximum</td>
<td align="left">5.42</td>
</tr>
</tbody>
</table>
<p>Now, say we want to only report the minimum and maximum for each of the numeric variables and for the categorical variables we want two show the denominator for each category and for the percentage, to one digit with the percent symbol in the table. Note that when defining the list of numeric_summaries that the argument place holder is the <code>%s</code> character.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new_summary &lt;-
<span class="st">  </span>mtcars2 <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(.data<span class="op">$</span>mpg, .data<span class="op">$</span>cyl_factor, .data<span class="op">$</span>wt) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">qsummary</span>(.,
           <span class="dt">numeric_summaries =</span> <span class="kw">list</span>(<span class="st">&quot;Minimum&quot;</span> =<span class="st"> &quot;~ min(%s)&quot;</span>,
                                    <span class="st">&quot;Maximum&quot;</span> =<span class="st"> &quot;~ max(%s)&quot;</span>),
           <span class="dt">n_perc_args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="dv">1</span>, <span class="dt">show_symbol =</span> <span class="ot">TRUE</span>, <span class="dt">show_denom =</span> <span class="st">&quot;always&quot;</span>))</code></pre></div>
<p>The resulting table is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary_table</span>(mtcars2, new_summary)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">mtcars2 (N = 32)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>mpg</strong></td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   Minimum</td>
<td align="left">10.4</td>
</tr>
<tr class="odd">
<td align="left">   Maximum</td>
<td align="left">33.9</td>
</tr>
<tr class="even">
<td align="left"><strong>cyl_factor</strong></td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   6 cylinders</td>
<td align="left">7/32 (21.9%)</td>
</tr>
<tr class="even">
<td align="left">   4 cylinders</td>
<td align="left">11/32 (34.4%)</td>
</tr>
<tr class="odd">
<td align="left">   8 cylinders</td>
<td align="left">14/32 (43.8%)</td>
</tr>
<tr class="even">
<td align="left"><strong>wt</strong></td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   Minimum</td>
<td align="left">1.513</td>
</tr>
<tr class="even">
<td align="left">   Maximum</td>
<td align="left">5.424</td>
</tr>
</tbody>
</table>
<p>The summary can easily be used on a grouped <code>data.frame</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars2 <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(.data<span class="op">$</span>am) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summary_table</span>(., new_summary)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">am: 0 (N = 19)</th>
<th align="left">am: 1 (N = 13)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>mpg</strong></td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   Minimum</td>
<td align="left">10.4</td>
<td align="left">15</td>
</tr>
<tr class="odd">
<td align="left">   Maximum</td>
<td align="left">24.4</td>
<td align="left">33.9</td>
</tr>
<tr class="even">
<td align="left"><strong>cyl_factor</strong></td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   6 cylinders</td>
<td align="left">4/19 (21.1%)</td>
<td align="left">3/13 (23.1%)</td>
</tr>
<tr class="even">
<td align="left">   4 cylinders</td>
<td align="left">3/19 (15.8%)</td>
<td align="left">8/13 (61.5%)</td>
</tr>
<tr class="odd">
<td align="left">   8 cylinders</td>
<td align="left">12/19 (63.2%)</td>
<td align="left">2/13 (15.4%)</td>
</tr>
<tr class="even">
<td align="left"><strong>wt</strong></td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   Minimum</td>
<td align="left">2.465</td>
<td align="left">1.513</td>
</tr>
<tr class="even">
<td align="left">   Maximum</td>
<td align="left">5.424</td>
<td align="left">3.57</td>
</tr>
</tbody>
</table>
</div>
<div id="adding-p-values-to-a-summary-table" class="section level2">
<h2><span class="header-section-number">3.2</span> Adding P-values to a Summary Table</h2>
<p>There are many, many different ways to format data summary tables. Adding p-values to a table is just one thing that can be done in more than one way. For example, if a row group reports the counts and percentages for each level of a categorical variable across multiple (column) groups, then I would argue that the p-value resulting from a chi square test or a Fisher exact test would be best placed on the line of the table labeling the row group. However, say we reported the minimum, median, mean, and maximum with in a row group for one variable. The p-value from a t-test, or other meaningful test, for the difference in mean I would suggest should be reported on the line of the summary table for the mean, not the row group itself.</p>
<p>With so many possibilities I have reserved construction of a p-value column to be ad hoc. Perhaps an additional column wouldn’t be used and the p-values are edited into row group labels, for example.</p>
<p>If you want to add a p-value column to a <code>qwraps2_summary_table</code> object you can with some degree of ease. Note that <code>qwraps2_summary_table</code> objects are just character matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">both <span class="op">%&gt;%</span><span class="st"> </span>str
##  'qwraps2_summary_table' chr [1:13, 1:4] &quot;10.4&quot; &quot;33.9&quot; ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:13] &quot;min&quot; &quot;max&quot; &quot;mean (sd)&quot; &quot;min&quot; ...
##   ..$ : chr [1:4] &quot;mtcars2 (N = 32)&quot; &quot;cyl_factor: 6 cylinders (N = 7)&quot; &quot;cyl_factor: 4 cylinders (N = 11)&quot; &quot;cyl_factor: 8 cylinders (N = 14)&quot;
##  - attr(*, &quot;rgroups&quot;)= Named int [1:4] 3 4 3 3
##   ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;Miles Per Gallon&quot; &quot;Displacement&quot; &quot;Weight (1000 lbs)&quot; &quot;Forward Gears&quot;</code></pre></div>
<p>Let’s added p-values for testing the difference in the mean between the three cylinder groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># difference in means</span>
mpvals &lt;-
<span class="st">  </span><span class="kw">list</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl_factor,  <span class="dt">data =</span> mtcars2),
       <span class="kw">lm</span>(disp <span class="op">~</span><span class="st"> </span>cyl_factor, <span class="dt">data =</span> mtcars2),
       <span class="kw">lm</span>(wt <span class="op">~</span><span class="st"> </span>cyl_factor,   <span class="dt">data =</span> mtcars2)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">lapply</span>(aov) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">lapply</span>(summary) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">lapply</span>(<span class="cf">function</span>(x) x[[<span class="dv">1</span>]][[<span class="st">&quot;Pr(&gt;F)&quot;</span>]][<span class="dv">1</span>]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">lapply</span>(frmtp) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">do.call</span>(c, .)

<span class="co"># Fisher test</span>
fpval &lt;-<span class="st"> </span><span class="kw">frmtp</span>(<span class="kw">fisher.test</span>(<span class="kw">table</span>(mtcars2<span class="op">$</span>gear, mtcars2<span class="op">$</span>cyl_factor))<span class="op">$</span>p.value)</code></pre></div>
<p>Adding the p-value column is done as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">both &lt;-<span class="st"> </span><span class="kw">cbind</span>(both, <span class="st">&quot;P-value&quot;</span> =<span class="st"> &quot;&quot;</span>)
both[<span class="kw">grepl</span>(<span class="st">&quot;mean </span><span class="ch">\\</span><span class="st">(sd</span><span class="ch">\\</span><span class="st">)&quot;</span>, <span class="kw">rownames</span>(both)), <span class="st">&quot;P-value&quot;</span>] &lt;-<span class="st"> </span>mpvals
a &lt;-<span class="st"> </span><span class="kw">capture.output</span>(<span class="kw">print</span>(both))
a[<span class="kw">grepl</span>(<span class="st">&quot;Forward Gears&quot;</span>, a)] <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot;&amp;nbsp;&amp;nbsp;</span><span class="ch">\\</span><span class="st"> </span><span class="ch">\\</span><span class="st">|$&quot;</span>, <span class="kw">paste</span>(fpval, <span class="st">&quot;|&quot;</span>), .)</code></pre></div>
<p>and the resulting table is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(a, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="14%"></col>
<col width="14%"></col>
<col width="20%"></col>
<col width="20%"></col>
<col width="20%"></col>
<col width="8%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">mtcars2 (N = 32)</th>
<th align="left">cyl_factor: 6 cylinders (N = 7)</th>
<th align="left">cyl_factor: 4 cylinders (N = 11)</th>
<th align="left">cyl_factor: 8 cylinders (N = 14)</th>
<th align="left">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Miles Per Gallon</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">10.4</td>
<td align="left">17.8</td>
<td align="left">21.4</td>
<td align="left">10.4</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   max</td>
<td align="left">33.9</td>
<td align="left">21.4</td>
<td align="left">33.9</td>
<td align="left">19.2</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">   mean (sd)</td>
<td align="left">20.09 ± 6.03</td>
<td align="left">19.74 ± 1.45</td>
<td align="left">26.66 ± 4.51</td>
<td align="left">15.10 ± 2.56</td>
<td align="left"><em>P</em> &lt; 0.0001</td>
</tr>
<tr class="odd">
<td align="left"><strong>Displacement</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">71.1</td>
<td align="left">145.0</td>
<td align="left">71.1</td>
<td align="left">275.8</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   median</td>
<td align="left">196.3</td>
<td align="left">167.6</td>
<td align="left">108.0</td>
<td align="left">350.5</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">   max</td>
<td align="left">472</td>
<td align="left">258.0</td>
<td align="left">146.7</td>
<td align="left">472.0</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">230.72 ± 123.94</td>
<td align="left">183.31 ± 41.56</td>
<td align="left">105.14 ± 26.87</td>
<td align="left">353.10 ± 67.77</td>
<td align="left"><em>P</em> &lt; 0.0001</td>
</tr>
<tr class="even">
<td align="left"><strong>Weight (1000 lbs)</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   min</td>
<td align="left">1.513</td>
<td align="left">2.620</td>
<td align="left">1.513</td>
<td align="left">3.170</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">   max</td>
<td align="left">5.424</td>
<td align="left">3.460</td>
<td align="left">3.190</td>
<td align="left">5.424</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">3.22 ± 0.98</td>
<td align="left">3.12 ± 0.36</td>
<td align="left">2.29 ± 0.57</td>
<td align="left">4.00 ± 0.76</td>
<td align="left"><em>P</em> &lt; 0.0001</td>
</tr>
<tr class="even">
<td align="left"><strong>Forward Gears</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left"><em>P</em> &lt; 0.0001</td>
</tr>
<tr class="odd">
<td align="left">   Three</td>
<td align="left">15 (47)</td>
<td align="left">2 (29)</td>
<td align="left">1 (9)</td>
<td align="left">12 (86)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">   Four</td>
<td align="left">12 (38)</td>
<td align="left">4 (57)</td>
<td align="left">8 (73)</td>
<td align="left">0 (0)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   Five</td>
<td align="left">5 (16)</td>
<td align="left">1 (14)</td>
<td align="left">2 (18)</td>
<td align="left">2 (14)</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>Another option you might consider is to have the p-value in the row group name. Consider the following construction. The p-values are added to the names of the row groups when building the summary table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gear_summary &lt;-
<span class="st">  </span><span class="kw">list</span>(<span class="st">&quot;Forward Gears&quot;</span> =
<span class="st">       </span><span class="kw">list</span>(<span class="st">&quot;Three&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">n_perc0</span>(.data<span class="op">$</span>gear <span class="op">==</span><span class="st"> </span><span class="dv">3</span>),
            <span class="st">&quot;Four&quot;</span>  =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">n_perc0</span>(.data<span class="op">$</span>gear <span class="op">==</span><span class="st"> </span><span class="dv">4</span>),
            <span class="st">&quot;Five&quot;</span>  =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">n_perc0</span>(.data<span class="op">$</span>gear <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)),
       <span class="st">&quot;Transmission&quot;</span> =
<span class="st">       </span><span class="kw">list</span>(<span class="st">&quot;Automatic&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">n_perc0</span>(.data<span class="op">$</span>am <span class="op">==</span><span class="st"> </span><span class="dv">0</span>),
            <span class="st">&quot;Manual&quot;</span>  =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">n_perc0</span>(.data<span class="op">$</span>am <span class="op">==</span><span class="st"> </span><span class="dv">1</span>))
       ) <span class="op">%&gt;%</span>
<span class="kw">setNames</span>(.,
         <span class="kw">c</span>(
         <span class="kw">paste</span>(<span class="st">&quot;Forward Gears: &quot;</span>, <span class="kw">frmtp</span>(<span class="kw">fisher.test</span>(<span class="kw">xtabs</span>( <span class="op">~</span><span class="st"> </span>gear <span class="op">+</span><span class="st"> </span>cyl_factor, <span class="dt">data =</span> mtcars2))<span class="op">$</span>p.value)),
         <span class="kw">paste</span>(<span class="st">&quot;Transmission: &quot;</span>,  <span class="kw">frmtp</span>(<span class="kw">fisher.test</span>(<span class="kw">xtabs</span>( <span class="op">~</span><span class="st"> </span>am <span class="op">+</span><span class="st"> </span>cyl_factor, <span class="dt">data =</span> mtcars2))<span class="op">$</span>p.value)))
         )

<span class="kw">summary_table</span>(dplyr<span class="op">::</span><span class="kw">group_by</span>(mtcars2, cyl_factor), gear_summary)</code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="25%"></col>
<col width="24%"></col>
<col width="25%"></col>
<col width="25%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">cyl_factor: 6 cylinders (N = 7)</th>
<th align="left">cyl_factor: 4 cylinders (N = 11)</th>
<th align="left">cyl_factor: 8 cylinders (N = 14)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Forward Gears: <em>P</em> &lt; 0.0001</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   Three</td>
<td align="left">2 (29)</td>
<td align="left">1 (9)</td>
<td align="left">12 (86)</td>
</tr>
<tr class="odd">
<td align="left">   Four</td>
<td align="left">4 (57)</td>
<td align="left">8 (73)</td>
<td align="left">0 (0)</td>
</tr>
<tr class="even">
<td align="left">   Five</td>
<td align="left">1 (14)</td>
<td align="left">2 (18)</td>
<td align="left">2 (14)</td>
</tr>
<tr class="odd">
<td align="left"><strong>Transmission: <em>P</em> = 0.0091</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   Automatic</td>
<td align="left">4 (57)</td>
<td align="left">3 (27)</td>
<td align="left">12 (86)</td>
</tr>
<tr class="odd">
<td align="left">   Manual</td>
<td align="left">3 (43)</td>
<td align="left">8 (73)</td>
<td align="left">2 (14)</td>
</tr>
</tbody>
</table>
</div>
<div id="using-variable-labels" class="section level2">
<h2><span class="header-section-number">3.3</span> Using Variable Labels</h2>
<p>Some data management paradigms will use attributes to keep a label associated with a variable in a data.frame. Notable examples are the <a href="https://cran.r-project.org/package=Hmisc">Hmisc</a> and <a href="https://cran.r-project.org/package=sjPlot">sjPlot</a>. If you associate a label with a variable in the data frame the that label will be used when building a summary table. This feature was suggested <a href="https://github.com/dewittpe/qwraps2/issues/74" class="uri">https://github.com/dewittpe/qwraps2/issues/74</a> and implemented thusly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new_data_frame &lt;-
<span class="st">  </span><span class="kw">data.frame</span>(<span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">24</span>, <span class="dv">17</span>, <span class="dv">43</span>),
             <span class="dt">edu =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">2</span>),
             <span class="dt">rt  =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.04</span>, <span class="fl">0.02</span>, <span class="fl">0.10</span>, <span class="fl">0.06</span>))

<span class="co"># Set a label for the variables</span>
<span class="kw">attr</span>(new_data_frame<span class="op">$</span>age, <span class="st">&quot;label&quot;</span>) &lt;-<span class="st"> &quot;Age in years&quot;</span>
<span class="kw">attr</span>(new_data_frame<span class="op">$</span>rt,  <span class="st">&quot;label&quot;</span>) &lt;-<span class="st"> &quot;Reaction time&quot;</span>

<span class="co"># mistakenly set the attribute to name instead of label</span>
<span class="kw">attr</span>(new_data_frame<span class="op">$</span>edu, <span class="st">&quot;name&quot;</span>) &lt;-<span class="st"> &quot;Education&quot;</span></code></pre></div>
<p>When calling <code>qsummary</code> the provide labels for the age and rt variables will be used. Since the attribute “label” does not exist for the edu variable, edu will be used in the output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qsummary</span>(new_data_frame)
## $`Age in years`
## $`Age in years`$minimum
## ~qwraps2::frmt(min(.data[[&quot;age&quot;]]))
## 
## $`Age in years`$`median (IQR)`
## ~qwraps2::median_iqr(.data[[&quot;age&quot;]])
## 
## $`Age in years`$`mean (sd)`
## ~qwraps2::mean_sd(.data[[&quot;age&quot;]])
## 
## $`Age in years`$maximum
## ~qwraps2::frmt(max(.data[[&quot;age&quot;]]))
## 
## 
## $edu
## $edu$minimum
## ~qwraps2::frmt(min(.data[[&quot;edu&quot;]]))
## 
## $edu$`median (IQR)`
## ~qwraps2::median_iqr(.data[[&quot;edu&quot;]])
## 
## $edu$`mean (sd)`
## ~qwraps2::mean_sd(.data[[&quot;edu&quot;]])
## 
## $edu$maximum
## ~qwraps2::frmt(max(.data[[&quot;edu&quot;]]))
## 
## 
## $`Reaction time`
## $`Reaction time`$minimum
## ~qwraps2::frmt(min(.data[[&quot;rt&quot;]]))
## 
## $`Reaction time`$`median (IQR)`
## ~qwraps2::median_iqr(.data[[&quot;rt&quot;]])
## 
## $`Reaction time`$`mean (sd)`
## ~qwraps2::mean_sd(.data[[&quot;rt&quot;]])
## 
## $`Reaction time`$maximum
## ~qwraps2::frmt(max(.data[[&quot;rt&quot;]]))</code></pre></div>
<p>This behavior is also seen with the <code>summary_table</code> call</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary_table</span>(new_data_frame)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">new_data_frame (N = 5)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Age in years</strong></td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   minimum</td>
<td align="left">17.00</td>
</tr>
<tr class="odd">
<td align="left">   median (IQR)</td>
<td align="left">20.00 (18.00, 24.00)</td>
</tr>
<tr class="even">
<td align="left">   mean (sd)</td>
<td align="left">24.40 ± 10.74</td>
</tr>
<tr class="odd">
<td align="left">   maximum</td>
<td align="left">43.00</td>
</tr>
<tr class="even">
<td align="left"><strong>edu</strong></td>
<td align="left">  </td>
</tr>
<tr class="odd">
<td align="left">   minimum</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td align="left">   median (IQR)</td>
<td align="left">2.00 (1.00, 3.00)</td>
</tr>
<tr class="odd">
<td align="left">   mean (sd)</td>
<td align="left">2.40 ± 1.67</td>
</tr>
<tr class="even">
<td align="left">   maximum</td>
<td align="left">5.00</td>
</tr>
<tr class="odd">
<td align="left"><strong>Reaction time</strong></td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   minimum</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td align="left">   median (IQR)</td>
<td align="left">0.04 (0.02, 0.06)</td>
</tr>
<tr class="even">
<td align="left">   mean (sd)</td>
<td align="left">0.05 ± 0.04</td>
</tr>
<tr class="odd">
<td align="left">   maximum</td>
<td align="left">0.10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="session-info" class="section level1">
<h1><span class="header-section-number">4</span> Session Info</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">sessionInfo</span>(), <span class="dt">local =</span> <span class="ot">FALSE</span>)
## R version 3.6.1 (2019-07-05)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.3 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/openblas/libblas.so.3
## LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] qwraps2_0.4.2 magrittr_1.5 
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.3       crayon_1.3.4     digest_0.6.23    dplyr_0.8.3     
##  [5] assertthat_0.2.1 R6_2.4.1         evaluate_0.14    highr_0.8       
##  [9] pillar_1.4.2     rlang_0.4.2      stringi_1.4.3    rmarkdown_1.18  
## [13] tools_3.6.1      stringr_1.4.0    glue_1.3.1       purrr_0.3.3     
## [17] xfun_0.11        yaml_2.2.0       compiler_3.6.1   pkgconfig_2.0.3 
## [21] htmltools_0.4.0  tidyselect_0.2.5 knitr_1.26       tibble_2.1.3</code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
